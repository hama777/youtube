<html>
<head>
<title>Youtube statistics</title>
<!-- 25/09/24 v1.57 自作曲集計の割合を別欄にした -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="you.css">
</head>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '回数'],
%daily_graph%
            ]);
    
            var options = {
                title: '日別回数',
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30 },
                colors: ['#00aae8'] ,
                hAxis: {title: '日'},
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.ColumnChart(document.getElementById('daily_graph'));
            chart.draw(data, options);
        }
    );
</script>

<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '回数'],
%move_ave_graph30%
            ]);
    
            var options = {
                title: '日別移動平均',
                colors: ['#00aae8'] ,
                hAxis: {title: '日'},
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30},
                curveType: 'function',
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.LineChart(document.getElementById('move_ave_graph30'));
            chart.draw(data, options);
        }
    );
</script>

<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '回数'],
%move_ave_graph90%
            ]);
    
            var options = {
                title: '日別移動平均',
                colors: ['#00aae8'] ,
                hAxis: {title: '日'},
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30},
                curveType: 'function',
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.LineChart(document.getElementById('move_ave_graph90'));
            chart.draw(data, options);
        }
    );
</script>

<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '回数'],
%move_ave_graph365%
            ]);
    
            var options = {
                title: '日別移動平均',
                colors: ['#00aae8'] ,
                hAxis: {title: '日'},
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30},
                curveType: 'function',
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.LineChart(document.getElementById('move_ave_graph365'));
            chart.draw(data, options);
        }
    );
</script>

<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '1日平均回数'],
%month_graph%
            ]);
    
            var options = {
                title: '月別回数',
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30 },
                colors: ['#00aae8'] ,
                hAxis: {title: '年月'},
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.ColumnChart(document.getElementById('monthly_graph'));
            chart.draw(data, options);
        }
    );
</script>
<script type="text/javascript">
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(
        function() {
            var data = google.visualization.arrayToDataTable([
    [       '', '回数'],
%covering_rate_graph%
            ]);
    
            var options = {
                title: '網羅率',
                colors: ['#00aae8'] ,
                hAxis: {title: '日'},
                chartArea: { backgroundColor: '#f1f7f9' , left:50,right:30},
                curveType: 'function',
                legend: { position: 'none' }
            };
    
            var chart = new google.visualization.LineChart(document.getElementById('covering_rate_graph'));
            chart.draw(data, options);
        }
    );
</script>

<h1>Youtube集計</h1>
<span style="font-size:12px;">Ver : %version%</span>
<span style="font-size:12px;">実行日時   : %today%</span>
<span style="font-size:12px;">最終データ : %lastdate%</span>
<h2>日別再生回数</h2>
<div id="daily_graph" style="width:800px; height:300px;  margin-top:20px ; margin-left:  50px; " ></div>
<br>
<h2>再生回数</h2>
<table id="myTable">
    <thead>
        <tr>
            <th></th><th>日集計</th><th colspan="2">週集計</th><th colspan="2">月集計</th>
            <th colspan="2">3ヶ月集計</th><th colspan="2">総集計</th>
            <th colspan="4">good</th><th></th>
        </tr>
        <tr>
            <th>タイトル</th><th>回数</th><th>　回数</th><th>　平均</th>
            <th>　回数</th><th>　平均</th><th>　回数</th><th>　平均</th>
            <th>　回数</th><th>　平均</th><th>件数</th><th>増分</th><th>率</th><th>月平均</th><th>登録日</th>
        </tr>
    </thead>
    <tbody>
        %replay_table
    </tbody>
</table>
<br>

<h2>タイトル別再生回数Top</h2>
<div class="flex">
    <div >
        <span style="margin-left: 30px;">昨日</span>
        <table class="rank">
            <tr>
                <th>順位</th><th>タイトル</th><th>回数</th>
            </tr>
            %top_replay%
        </table>
    </div>
    <div >
        <span style="margin-left: 30px;">1週間</span>
        <table class="rank">
            <tr>
                <th>順位</th><th>タイトル</th><th>回数</th>
            </tr>
            %top_replay_week%
        </table>
    </div>
    <div >
        <span style="margin-left: 30px;">1ヶ月</span>
        <table class="rank">
            <tr>
                <th>順位</th><th>タイトル</th><th>回数</th>
            </tr>
            %top_replay_month%
        </table>
    </div>
    <div >
        <span style="margin-left: 30px;">3ヶ月</span>
        <table class="rank">
            <tr>
                <th>順位</th><th>タイトル</th><th>回数</th>
            </tr>
            %top_replay_month3%
        </table>
    </div>
</div>
<br>
<h2>自作曲集計</h2>
<table>
    <th>日付</th><th>日</th><th>日割合</th><th>週</th><th>週割合</th><th>月</th><th>月割合</th><th>3ヶ月</th><th>3ヶ月割合</th>
    %selfmade_table%
</table>
<br>
<h2>日別再生移動平均</h2>
<div class="flex">
    <div class='frame'>
        <span style="margin-left: 30px;">30日</span>
        <div id="move_ave_graph30" style="width:600px; height:300px;  margin-top:5px ; margin-left:  10px; margin-right:  10px;" ></div>
        <br>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">365日</span>
        <div id="move_ave_graph365" style="width:600px; height:300px;  margin-top:5px ; margin-left:  10px; margin-right:  10px;" ></div>
        <br>
    </div>
</div>
<br>

<h2>月別平均再生回数</h2>
<div id="monthly_graph" style="width:800px; height:400px;  margin-top:20px ; margin-left:  50px; " ></div>

<h2>月別再生回数ランキング</h2>
<div class="flex">
    <div class='frame'>
        <span style="margin-left: 30px;">Top</span>
        <table class="rank">
        <tr><th>順位</th><th>年月</th><th>回数</th></tr>
        %month_rank_top%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">Low</span>
        <table class="rank">
        <tr><th>順位</th><th>年月</th><th>回数</th></tr>
        %month_rank_low%
        </table>
    </div>
</div>
<br>

<h2>状況</h2>
<iframe src="https://pixe.la/v1/users/hama777/graphs/youtube?mode=simple" height="155" width="720" frameborder="0">
</iframe>
<h2>再生回数ランキング 最大</h2>
<div class="flex">
    <div class='frame'>
        <span style="margin-left: 30px;">総合 (1～10位)</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %daily_rank1%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">総合 (11～20位)</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %daily_rank2%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">過去365日</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %year_rank%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">過去30日</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %monthly_rank%
        </table>
    </div>

</div>
<h2>再生回数ランキング 最小</h2>
<div class="flex">
    <div class='frame'>
        <span style="margin-left: 30px;">総合 (1～10位)</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %daily_rank3%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">総合 (11～20位)</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %daily_rank4%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">過去365日</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %year_rank_min%
        </table>
    </div>
    <div class='frame'>
        <span style="margin-left: 30px;">過去30日</span>
        <table class="rank">
        <tr><th>順位</th><th>日付</th><th>回数</th></tr>
        %monthly_rank2%
        </table>
    </div>
</div>
<h2>網羅率</h2>
<div class="flex">
    <div class='frame'>
        <table class="rank">
            <tr>
                <th>日付</th><th>日</th><th>週</th><th>月</th><th>3ヶ月</th>
            </tr>
            %covering_rate1%
        </table>
    </div>
    <div class='frame'>
        <table class="rank">
            <tr>
                <th>日付</th><th>日</th><th>週</th><th>月</th><th>3ヶ月</th>
            </tr>
            %covering_rate2%
        </table>
    </div>
</div>
<h2>網羅率グラフ</h2>
<div id="covering_rate_graph" style="width:800px; height:400px;  margin-top:20px ; margin-left:  50px; " ></div>

<script>
    const table = document.getElementById("myTable");
    const headerRows = table.querySelectorAll("thead tr");
    const secondHeaderCells = headerRows[1].querySelectorAll("th");
  
    let sortColumn = -1;
    let sortDirection = 0; // 1: 昇順, -1: 降順
  
    secondHeaderCells.forEach((header, index) => {
      header.addEventListener("click", () => {
        // ソート対象の列インデックス
        if (sortColumn === index) {
    sortDirection *= -1; // クリックを繰り返したときの切り替え
  } else {
    sortColumn = index;
    sortDirection = -1; // ← 最初のクリックで降順になるよう明示的に指定
  }
  
        // ソート状態のリセット
        secondHeaderCells.forEach(h => h.classList.remove("sorted-asc", "sorted-desc"));
        header.classList.add(sortDirection === 1 ? "sorted-asc" : "sorted-desc");
  
        const tbody = table.querySelector("tbody");
        const rows = Array.from(tbody.querySelectorAll("tr"));
  
        rows.sort((a, b) => {
          const cellA = a.children[sortColumn].textContent.trim();
          const cellB = b.children[sortColumn].textContent.trim();
  
          const valA = isNaN(cellA) ? cellA : parseFloat(cellA);
          const valB = isNaN(cellB) ? cellB : parseFloat(cellB);
  
          if (valA < valB) return -1 * sortDirection;
          if (valA > valB) return 1 * sortDirection;
          return 0;
        });
  
        // 並べ替えた行を再追加
        rows.forEach(row => tbody.appendChild(row));
      });
    });
  </script>


</body>
</html>


